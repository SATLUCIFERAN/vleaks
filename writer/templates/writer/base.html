{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- Dynamic Title -->
    <title>{% block title %}Writer Panel - V-Leaks{% endblock %}</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Writer Panel CSS -->
    <link rel="stylesheet" href="{% static 'writer/css/writer.css' %}">
    
    <!-- Extra CSS (child templates can add more) -->
    {% block extra_css %}{% endblock %}
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleSidebar()">
        â˜°
    </button>

    <!-- ========== SIDEBAR ========== -->
    <div class="sidebar" id="sidebar">        
        <!-- Profile Section -->
        <div class="sidebar-profile px-3 py-3 mb-3">
            <div class="d-flex align-items-center">                
                <!-- Avatar: Show image if exists, otherwise show letter -->
                {% if request.user.profile.avatar %}
                    <img src="{{ request.user.profile.avatar.url }}" 
                         alt="Profile Picture" 
                         class="profile-avatar-img">
                {% else %}
                    <div class="profile-avatar">
                        {{ request.user.username|slice:":1"|upper }}
                    </div>
                {% endif %}        
                <div class="ms-3">
                    <h6 class="mb-0 text-white">{{ request.user.username }}</h6>
                    <small class="text-muted">{{ request.user.email|default:"Writer" }}</small>
                </div>
            </div>
        </div>

        <!-- Brand -->
        <div class="px-3 mb-3">
            <h4 class="sidebar-brand">ğŸ”¥ V-LEAKS</h4>
        </div>  

        <nav>
            <a href="{% url 'writer_dashboard' %}" 
               class="sidebar-link {% block nav_dashboard %}{% endblock %}">
                ğŸ“Š Dashboard
            </a>
            <a href="#" class="sidebar-link {% block nav_articles %}{% endblock %}">
                ğŸ“ My Articles
            </a>
            <a href="{% url 'create_article' %}"  
               class="sidebar-link {% block nav_create %}{% endblock %}">
                âœï¸ Create Article
            </a>
             <a href="{% url 'profile_settings' %}" 
                class="sidebar-link {% block nav_profile %}{% endblock %}">
                âš™ï¸ Profile Settings
            </a>
            <hr class="border-secondary mx-3">
            <a href="/" class="sidebar-link">
                ğŸŒ View Site
            </a>
            <a href="{% url 'writer_logout' %}" class="sidebar-link">
                ğŸšª Logout
            </a>
        </nav>

    </div>
    
    <!-- ========== MAIN CONTENT ========== -->
    <div class="main-content">
        {% include 'writer/_messages.html' %}
        {% block content %}
        <!-- Child templates put their content here -->
        {% endblock %}
    </div>    

     <!-- Mobile Sidebar Toggle -->
    <script>
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            sidebar.classList.toggle('open');
        }
        
        // Close sidebar when clicking outside
        document.addEventListener('click', function(event) {
            const sidebar = document.getElementById('sidebar');
            const toggle = document.querySelector('.mobile-menu-toggle');
            
            if (window.innerWidth <= 768) {
                if (!sidebar.contains(event.target) && !toggle.contains(event.target)) {
                    sidebar.classList.remove('open');
                }
            }
        });
    </script>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Extra JS (child templates can add more) -->
    {% block extra_js %}{% endblock %}
</body>
</html>